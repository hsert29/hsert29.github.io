<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
    <title>Security Operations and Incident Response</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="../assets/css/main.css" />
    <noscript>
        <link rel="stylesheet" href="../assets/css/noscript.css" />
    </noscript>
</head>

<body class="is-preload">

    <!-- Header -->
    <header id="header">
        <a href="../index.html" class="title">Home</a>
        <!-- <nav>
					<ul>
						<li><a href="../index.html">Home</a></li>
						<li><a href="generic.html" class="active">Generic</a></li>
						<li><a href="../elements.html">Elements</a></li>
					</ul>
				</nav> -->
    </header>

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Main -->
        <section id="main" class="wrapper">
            <div class="inner">
                <div class="spacer">
                    <h1 class="major">Security Operations and Incident Response</h1>
                    <span class="image right"><img src="../images/sec_timeline.jpg" alt="" /></span>
                    <p> Often referred to as the “blue team”, the SOC is responsible for
                        defending our systems and our networks. They will proactively monitor activity, triage alerts against published
                        threat reports, and will provide incident response in the case of a breach. Using Splunk, I will investigate a scenario
                        where attackers have gained access to our web server and defaced our website. I will find out who the attacker was and 
                        explore ways to prevent further attacks.
                    </p>
                </div>

                <ul class="alt spacer">
                    <li>
                        <h2> Reconnaissance </h2>
                        <h4>What IP is scanning our web server?</h4>
                        <p style="overflow: auto;">
                            <span class="image left"><img src="../images/src_ip.jpg" alt="" /></span>
                            Following the questions listed out on the THY room, my first task was to find the IP address that was scanning our web server.
                            After running <code>index="botsv1" imreallynotbatman sourcetype="stream:http" | stats count by src_ip</code> I was able to list 
                            IP addresses that had scanned our web server and figure out which of these adresses had more traffic to our server. 
                        </p>
                        
                        <h4>What web scanner scanned the server?</h4>
                        <p style="overflow: auto;">
                            <span class="image left"><img src="../images/src_header.jpg" alt="" /></span>
                            Looking at the <code>index="botsv1" imreallynotbatman sourcetype="stream:http" | stats count by src_headers</code> I found out what web scanner they've used to scan our server which was <b>Acunetix</b>.
                        </p>
                        <!-- <p style="overflow: auto;">
                            <span class="image left"><img src="../images/src_ip.jpg" alt="" /></span>
                            Running <code>index="botsv1" src=40.80.148.42 sourcetype="stream:http"
                            | stats count by dest</code> I found out the IP address of our web server.
                        </p> -->
                        <h4>What content management system is imreallynotbatman.com using</h4>
                        <p style="overflow: auto;">
                            <span class="image left"><img src="../images/contentmgm.jpg" alt="" /></span>
                            Running <code>index="botsv1" src=40.80.148.42 sourcetype="stream:http" dest="192.168.250.70"
                            | stats count by uri
                            | sort - count</code> I found out what content management system they were using which was <b>Joomla</b>.
                        </p>
                    </li>
                    <li>
                        <h2> Exploitation </h2>
                        <h4>What address is performing the brute-forcing attack against our website?</h4>
                        <p style="overflow: auto;">
                            <span class="image left"><img src="../images/bruteforcesrc.jpg" alt="" /></span>
                            Running <code>index="botsv1" src=40.80.148.42 sourcetype="stream:http" dest="192.168.250.70"
                            | stats count by src_ip</code> I found out what address was performing the brute-force attack against our website. We can deduce
                            by the number of attempts made by <b>23.22.63.114</b> that this is the IP address responsible for the attacks.
                        </p>
                        
                        <h4>What was the first password attempted in the attack?</h4>
                        <p style="overflow: auto;">
                            <span class="image left"><img src="../images/bruteforcefirstpswd.jpg" alt="" /></span>
                            In order to find the first attempted password I had to sort the data by time, running <code>index="botsv1" sourcetype="stream:http" 
                            dest="192.168.250.70" http_method=POST form_data=*username*passwd* | table _time, form_data | sort by _time </code>. We can see that
                            the first attempted password is <b>12345678</b>.
                        </p>

                        <h4>What was the correct password for admin access to the content management system running imreallynotbatman.com?</h4>
                        <p style="overflow: auto;">
                            <span class="image left"><img src="../images/bruteforcecorrectpswd.jpg" alt="" /></span>
                            There are couple of ways to find the correct password that the brute-force attack found. We know that brute-force tools like
                            <b>hydra</b> re-enter the correct password twice in order to verify that it works. I could've written a query that finds the password
                            that was attempted twice, however, I chose a different option. Logic dictates that the correct password would also be the final attempted
                            password. Therefore, running the previous command in descending order, <code>sort by _time desc</code>, would list the last and the correct 
                            password which is <b>batman</b>. 
                        </p>
                    </li>
                    <li>
                        <h2> 3 </h2>
                    </li>

                </ul>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer id="footer" class="wrapper alt">
        <div class="inner">
            <ul class="menu">
                <li>&copy; Huseyin Sert. All rights reserved.</li>
                <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
            </ul>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/jquery.scrollex.min.js"></script>
    <script src="../assets/js/jquery.scrolly.min.js"></script>
    <script src="../assets/js/browser.min.js"></script>
    <script src="../assets/js/breakpoints.min.js"></script>
    <script src="../assets/js/util.js"></script>
    <script src="../assets/js/main.js"></script>

    <!-- <script>
				$(function () {
					$(".pentest").load("../components/pentest-comp.html .pentest");
					$(".test").load("../components/pentest-comp.html .test");
				});
			</script> -->

</body>

</html>